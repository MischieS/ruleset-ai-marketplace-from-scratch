<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ruleset AI Product Suite</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div class="bg-mesh" aria-hidden="true"></div>

    <header class="topbar">
      <div class="brand">
        <strong>Ruleset AI</strong>
        <span>Marketplace Product Suite</span>
      </div>
      <nav class="main-nav" aria-label="Primary">
        <a href="#home" data-route="home">Home</a>
        <a href="#marketplace" data-route="marketplace">Marketplace</a>
        <a href="#user" data-route="user">User</a>
        <a href="#seller" data-route="seller">Seller</a>
        <a href="#admin" data-route="admin">Admin</a>
      </nav>
      <div class="topbar-actions">
        <span id="authState" class="auth-inline">Not logged in</span>
        <button id="refreshAllBtn" type="button">Refresh</button>
      </div>
    </header>

    <div class="app-grid">
      <aside class="rail left-rail" aria-label="Control rail">
        <section class="panel">
          <h2>Auth Control</h2>
          <p class="hint">Demo password: <code>demo1234</code></p>
          <p class="hint">Accounts: buyer, sellers, admin on <code>@demo.local</code></p>
          <form id="loginForm" class="stack-form">
            <input id="emailInput" type="email" placeholder="Email" required />
            <input id="passwordInput" type="password" placeholder="Password" required />
            <button type="submit" class="primary">Sign In</button>
          </form>
          <div class="button-grid">
            <button id="logoutBtn" type="button">Logout</button>
            <button id="quickMeBtn" type="button">My Profile</button>
            <button id="quickOrdersBtn" type="button">My Orders</button>
            <button id="quickFinanceBtn" type="button">Seller Finance</button>
            <button id="quickPromotionsBtn" type="button">Seller Promotions</button>
            <button id="quickPayoutsBtn" type="button">Admin Payouts</button>
          </div>
        </section>

        <section class="panel">
          <h2>Product KPIs</h2>
          <dl class="metric-list">
            <div>
              <dt>Total Assets</dt>
              <dd id="metricProducts">0</dd>
            </div>
            <div>
              <dt>Avg Efficiency</dt>
              <dd id="metricAvgScore">0.0</dd>
            </div>
            <div>
              <dt>Sponsored Ratio</dt>
              <dd id="metricSponsoredRatio">0%</dd>
            </div>
            <div>
              <dt>Top Seller</dt>
              <dd id="metricTopSeller">-</dd>
            </div>
          </dl>
        </section>
      </aside>

      <main class="pages" id="pages">
        <section id="page-home" class="page">
          <div class="panel hero">
            <p class="eyebrow">Production-Ready Operating Model</p>
            <h1>Build, rank, sell, and govern AI assets from one marketplace workflow.</h1>
            <p>
              This product shell is structured around real surfaces: acquisition homepage, buyer usage, seller economics,
              marketplace conversion, and admin governance.
            </p>
            <div class="hero-actions">
              <button id="gotoMarketplaceBtn" type="button" class="primary">Explore Marketplace</button>
              <button id="gotoSellerBtn" type="button">Open Seller Hub</button>
            </div>
          </div>

          <div class="grid-2">
            <section class="panel">
              <h2>Top Assets</h2>
              <div id="homeTopProducts" class="list-stack"></div>
            </section>
            <section class="panel">
              <h2>Top Sellers</h2>
              <div id="homeTopSellers" class="list-stack"></div>
            </section>
          </div>

          <section class="panel">
            <h2>Execution Principles</h2>
            <ul class="principles">
              <li>Fast interactions over heavy animation.</li>
              <li>Role-based depth: simple for end users, power tools for operators.</li>
              <li>Transparent marketplace economics and policy states.</li>
              <li>Accessible defaults with progressive complexity.</li>
            </ul>
          </section>
        </section>

        <section id="page-marketplace" class="page" hidden>
          <section class="panel">
            <h1>Marketplace</h1>
            <p class="hint">Search, compare, and transact with score-backed listings.</p>

            <div class="filters">
              <input id="searchInput" placeholder="Search by title, description, tag" />
              <select id="viewMode">
                <option value="catalog">Catalog</option>
                <option value="discovery">Discovery Feed</option>
              </select>
              <select id="typeFilter">
                <option value="">All Types</option>
                <option value="rule">Rules</option>
                <option value="skill">Skills</option>
                <option value="agent">Agents</option>
                <option value="n8n_workflow">n8n Workflows</option>
              </select>
              <select id="sortFilter">
                <option value="score">Top Efficiency</option>
                <option value="likes">Most Liked</option>
                <option value="new">Newest</option>
              </select>
              <select id="slotFilter">
                <option value="8">8 Slots</option>
                <option value="12" selected>12 Slots</option>
                <option value="16">16 Slots</option>
              </select>
            </div>

            <div id="marketplaceList" class="market-list"></div>
          </section>
        </section>

        <section id="page-user" class="page" hidden>
          <section class="panel">
            <h1>User Workspace</h1>
            <p class="hint">Order history, conversation context, and account state.</p>
            <div id="userSummary" class="summary-row"></div>
          </section>

          <section class="panel">
            <div class="section-head">
              <h2>My Orders</h2>
              <button id="userRefreshOrdersBtn" type="button">Refresh Orders</button>
            </div>
            <div id="userOrders" class="table-wrap"></div>
          </section>

          <section class="panel">
            <h2>Message Thread Lookup</h2>
            <form id="threadForm" class="filters">
              <input id="threadProductIdInput" placeholder="Product ID" required />
              <input id="threadWithUserIdInput" placeholder="Other User ID" required />
              <button type="submit">Load Thread</button>
            </form>
            <div id="threadOutput" class="table-wrap"></div>
          </section>
        </section>

        <section id="page-seller" class="page" hidden>
          <section class="panel">
            <h1>Seller Workspace</h1>
            <p class="hint">Finance, promotions, payout operations, and response SLA.</p>
            <div id="sellerSummary" class="summary-row"></div>
          </section>

          <div class="grid-2">
            <section class="panel">
              <div class="section-head">
                <h2>Finance</h2>
                <button id="sellerRefreshFinanceBtn" type="button">Refresh</button>
              </div>
              <div id="sellerFinance" class="table-wrap"></div>
              <button id="requestPayoutBtn" type="button" class="primary">Request Payout</button>
            </section>

            <section class="panel">
              <div class="section-head">
                <h2>SLA</h2>
                <button id="sellerRefreshSlaBtn" type="button">Refresh</button>
              </div>
              <div id="sellerSla" class="table-wrap"></div>
            </section>
          </div>

          <section class="panel">
            <h2>Create Promotion Campaign</h2>
            <form id="promotionCreateForm" class="filters">
              <input id="promotionProductIdInput" placeholder="Product ID" required />
              <input id="promotionBidInput" type="number" min="1" step="0.1" placeholder="Bid CPM (USD)" required />
              <input id="promotionBudgetInput" type="number" min="10" step="1" placeholder="Daily Budget (USD)" required />
              <button type="submit" class="primary">Create Campaign</button>
            </form>
          </section>

          <section class="panel">
            <h2>Campaign Status Update</h2>
            <form id="promotionStatusForm" class="filters">
              <input id="promotionCampaignIdInput" placeholder="Campaign ID" required />
              <select id="promotionStatusInput">
                <option value="paused">Pause</option>
                <option value="active">Activate</option>
              </select>
              <button type="submit">Update Status</button>
            </form>
          </section>

          <section class="panel">
            <div class="section-head">
              <h2>Campaigns</h2>
              <button id="sellerRefreshPromotionsBtn" type="button">Refresh</button>
            </div>
            <div id="sellerPromotions" class="table-wrap"></div>
          </section>
        </section>

        <section id="page-admin" class="page" hidden>
          <section class="panel">
            <h1>Admin Workspace</h1>
            <p class="hint">Payout approvals and governance operations.</p>
            <div class="section-head">
              <h2>Pending Payouts</h2>
              <button id="adminRefreshPayoutsBtn" type="button">Refresh</button>
            </div>
            <div id="adminPayouts" class="table-wrap"></div>
          </section>
        </section>
      </main>

      <aside class="rail right-rail" aria-label="System rail">
        <section class="panel">
          <h2>Response Log</h2>
          <pre id="systemOutput" class="output"></pre>
        </section>

        <section class="panel">
          <h2>Production Checklist</h2>
          <ul class="principles compact">
            <li>Role access tested per page.</li>
            <li>API failures surfaced with clear fallback copy.</li>
            <li>Mobile layout validated for all pages.</li>
            <li>Core metrics visible to operators.</li>
          </ul>
        </section>
      </aside>
    </div>

    <script type="module" src="/app.js"></script>
  </body>
</html>
